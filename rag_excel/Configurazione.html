<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RAG Excel Architecture</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
        }
        .diagram {
            width: 100%;
            height: 600px;
            margin: 20px 0;
            border-radius: 5px;
        }
        .legend {
            margin-top: 20px;
            border-top: 1px solid #eee;
            padding-top: 20px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        .legend-color {
            width: 20px;
            height: 20px;
            margin-right: 10px;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>RAG Excel + OpenWebUI Architecture</h1>
        
        <div class="diagram">
            <svg width="100%" height="100%" viewBox="0 0 800 600">
                <!-- Background -->
                <rect x="0" y="0" width="800" height="600" fill="#f8f9fa" rx="10" ry="10" />
                
                <!-- RAG Excel System -->
                <rect x="50" y="50" width="350" height="500" fill="#e3f2fd" rx="10" ry="10" stroke="#2196f3" stroke-width="2" />
                <text x="225" y="80" text-anchor="middle" font-weight="bold" font-size="16">RAG Excel System</text>
                
                <!-- Excel Loader -->
                <rect x="80" y="100" width="120" height="60" fill="#bbdefb" rx="5" ry="5" stroke="#1976d2" stroke-width="1" />
                <text x="140" y="138" text-anchor="middle" font-size="12">Excel Loader</text>
                
                <!-- Vector Store -->
                <rect x="80" y="200" width="120" height="60" fill="#bbdefb" rx="5" ry="5" stroke="#1976d2" stroke-width="1" />
                <text x="140" y="238" text-anchor="middle" font-size="12">Vector Store</text>
                
                <!-- RAG Chain -->
                <rect x="80" y="300" width="120" height="60" fill="#bbdefb" rx="5" ry="5" stroke="#1976d2" stroke-width="1" />
                <text x="140" y="338" text-anchor="middle" font-size="12">RAG Chain</text>
                
                <!-- FastAPI -->
                <rect x="80" y="400" width="120" height="60" fill="#bbdefb" rx="5" ry="5" stroke="#1976d2" stroke-width="1" />
                <text x="140" y="438" text-anchor="middle" font-size="12">FastAPI</text>
                
                <!-- OpenWebUI System -->
                <rect x="450" y="50" width="300" height="500" fill="#fff8e1" rx="10" ry="10" stroke="#ffc107" stroke-width="2" />
                <text x="600" y="80" text-anchor="middle" font-weight="bold" font-size="16">OpenWebUI</text>
                
                <!-- OpenWebUI Function -->
                <rect x="480" y="150" width="240" height="60" fill="#ffecb3" rx="5" ry="5" stroke="#ffa000" stroke-width="1" />
                <text x="600" y="188" text-anchor="middle" font-size="12">RAG Excel Function</text>
                
                <!-- OpenWebUI Chat Interface -->
                <rect x="480" y="300" width="240" height="100" fill="#ffecb3" rx="5" ry="5" stroke="#ffa000" stroke-width="1" />
                <text x="600" y="338" text-anchor="middle" font-size="12">Chat Interface</text>
                <text x="600" y="358" text-anchor="middle" font-size="10">User Interaction</text>
                
                <!-- External Services -->
                <rect x="200" y="470" width="400" height="60" fill="#e8f5e9" rx="5" ry="5" stroke="#4caf50" stroke-width="1" />
                <text x="400" y="505" text-anchor="middle" font-size="12">OpenAI API (Embeddings + LLM)</text>
                
                <!-- Connections -->
                <!-- Excel to Vector Store -->
                <line x1="140" y1="160" x2="140" y2="200" stroke="#1976d2" stroke-width="2" />
                <polygon points="140,200 135,190 145,190" fill="#1976d2" />
                
                <!-- Vector Store to RAG Chain -->
                <line x1="140" y1="260" x2="140" y2="300" stroke="#1976d2" stroke-width="2" />
                <polygon points="140,300 135,290 145,290" fill="#1976d2" />
                
                <!-- RAG Chain to FastAPI -->
                <line x1="140" y1="360" x2="140" y2="400" stroke="#1976d2" stroke-width="2" />
                <polygon points="140,400 135,390 145,390" fill="#1976d2" />
                
                <!-- FastAPI to OpenWebUI Function -->
                <path d="M200 430 L390 430 L390 180 L480 180" stroke="#6200ea" stroke-width="2" fill="none" />
                <polygon points="480,180 470,175 470,185" fill="#6200ea" />
                
                <!-- OpenWebUI Function to Chat Interface -->
                <line x1="600" y1="210" x2="600" y2="300" stroke="#ffa000" stroke-width="2" />
                <polygon points="600,300 595,290 605,290" fill="#ffa000" />
                
                <!-- RAG System to OpenAI -->
                <line x1="200" y1="330" x2="250" y2="470" stroke="#4caf50" stroke-width="2" />
                <polygon points="250,470 245,460 255,460" fill="#4caf50" />
                
                <!-- Chat Interface to OpenAI -->
                <line x1="600" y1="400" x2="550" y2="470" stroke="#4caf50" stroke-width="2" />
                <polygon points="550,470 545,460 555,460" fill="#4caf50" />
                
                <!-- Data flow arrows -->
                <text x="120" y="185" text-anchor="middle" font-size="10" fill="#1976d2">Data</text>
                <text x="120" y="285" text-anchor="middle" font-size="10" fill="#1976d2">Embeddings</text>
                <text x="120" y="385" text-anchor="middle" font-size="10" fill="#1976d2">Answers</text>
                <text x="390" y="160" text-anchor="middle" font-size="10" fill="#6200ea">HTTP API</text>
                <text x="620" y="260" text-anchor="middle" font-size="10" fill="#ffa000">Context</text>
                <text x="220" y="400" text-anchor="middle" font-size="10" fill="#4caf50">Queries</text>
                <text x="570" y="440" text-anchor="middle" font-size="10" fill="#4caf50">Responses</text>
            </svg>
        </div>
        
        <div class="legend">
            <h3>Legend</h3>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #e3f2fd; border: 1px solid #2196f3;"></div>
                <div>RAG Excel System Components</div>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #fff8e1; border: 1px solid #ffc107;"></div>
                <div>OpenWebUI Components</div>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #e8f5e9; border: 1px solid #4caf50;"></div>
                <div>External Services</div>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: transparent; border: 2px solid #6200ea;"></div>
                <div>API Communication</div>
            </div>
        </div>
    </div>
</body>
</html>